(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{1181:function(e,r,a){Promise.resolve().then(a.bind(a,9738))},9738:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return p}});var t=a(7437),s=a(2265),n=a(6410);let o=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920;return new Promise((a,t)=>{let s=new FileReader;s.readAsDataURL(e),s.onload=e=>{var s;let n=new Image;n.src=null===(s=e.target)||void 0===s?void 0:s.result,n.onload=()=>{let e=document.createElement("canvas"),s=n.width,o=n.height;s>r&&(o=Math.round(o*r/s),s=r),e.width=s,e.height=o;let i=e.getContext("2d");if(!i){t(Error("Could not get canvas context"));return}i.drawImage(n,0,0,s,o),e.toBlob(e=>{e?a(e):t(Error("Could not compress image"))},"image/jpeg",.85)},n.onerror=e=>t(e)},s.onerror=e=>t(e)})},i=e=>URL.createObjectURL(e);var l=a(7356),c=a.n(l);let u="dsk1mj71x",d="Menu de la semaine pepperoni";function p(){let[e,r]=(0,s.useState)(!1),[a,l]=(0,s.useState)(""),[p,m]=(0,s.useState)(""),[g,h]=(0,s.useState)(""),[_,f]=(0,s.useState)(""),[x,j]=(0,s.useState)("restaurant"),[v,b]=(0,s.useState)([]),[y,w]=(0,s.useState)("menu"),[N,D]=(0,s.useState)(!1),[C,S]=(0,s.useState)(0),[I,E]=(0,s.useState)(!1),[k,B]=(0,s.useState)(!0);(0,s.useEffect)(()=>{"true"===sessionStorage.getItem("trapeneck_admin")&&r(!0);let e=async()=>{b(await (0,n.NQ)())};(async()=>{let e=await (0,n.NA)();e&&h(e),B(!1)})(),e()},[]),(0,s.useEffect)(()=>{let e=e=>{N&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[N]),(0,s.useEffect)(()=>()=>{_&&URL.revokeObjectURL(_)},[_]);let A=async e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(a){E(!1),m(""),S(0),f(i(a)),D(!0),S(10);try{S(20);let e=await o(a);S(40);let r=new FormData;r.append("file",e),r.append("upload_preset",d);let t=await fetch("https://api.cloudinary.com/v1_1/".concat(u,"/image/upload"),{method:"POST",body:r});S(80);let s=await t.json();if(s.secure_url){let e=await (0,n.vU)(s.secure_url);S(95),e.success?(h(s.secure_url),f(""),E(!0),S(100)):m("Erreur sauvegarde: ".concat(e.error))}else m("Erreur upload Cloudinary.")}catch(e){m("Erreur de connexion. R\xe9essayez."),console.error(e)}finally{D(!1)}}},F=async e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(a){D(!0),S(10),m("");try{S(30);let e=await o(a),r=new FormData;r.append("file",e),r.append("upload_preset",d);let t=await fetch("https://api.cloudinary.com/v1_1/".concat(u,"/image/upload"),{method:"POST",body:r});S(70);let s=await t.json();if(s.secure_url){let e=await (0,n.Ve)(s.secure_url,x);if(S(100),e.success){let e=await (0,n.NQ)();b(e),E(!0),setTimeout(()=>E(!1),3e3)}else m("Erreur sauvegarde: ".concat(e.error))}}catch(e){m("Erreur upload."),console.error(e)}finally{D(!1),S(0)}}},R=async e=>{if(confirm("Voulez-vous vraiment supprimer cette image ?")){let r=await (0,n.vX)(e);r.success?b(await (0,n.NQ)()):alert("Erreur: "+r.error)}};return e?(0,t.jsx)("div",{className:c().container,children:(0,t.jsxs)("div",{className:c().adminPanel,children:[(0,t.jsxs)("div",{className:c().header,children:[(0,t.jsx)("h1",{children:"\uD83C\uDF5D Admin Trapeneck"}),(0,t.jsx)("button",{onClick:()=>{r(!1),sessionStorage.removeItem("trapeneck_admin")},className:c().logoutBtn,children:"D\xe9connexion"})]}),(0,t.jsxs)("div",{className:c().tabs,style:{display:"flex",gap:"1rem",marginBottom:"2rem",justifyContent:"center"},children:[(0,t.jsx)("button",{onClick:()=>w("menu"),style:{padding:"0.75rem 1.5rem",borderRadius:"2rem",border:"none",background:"menu"===y?"#E31837":"#f0f0f0",color:"menu"===y?"white":"#333",fontWeight:"bold",cursor:"pointer"},children:"\uD83D\uDCCB Menu du Jour"}),(0,t.jsx)("button",{onClick:()=>w("gallery"),style:{padding:"0.75rem 1.5rem",borderRadius:"2rem",border:"none",background:"gallery"===y?"#E31837":"#f0f0f0",color:"gallery"===y?"white":"#333",fontWeight:"bold",cursor:"pointer"},children:"\uD83D\uDDBC️ Gestion Galerie"})]}),"menu"===y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:c().uploadSection,children:[(0,t.jsx)("h2",{children:"\uD83D\uDCCB Menu de la Semaine"}),(0,t.jsxs)("div",{className:c().stepGuide,children:[(0,t.jsxs)("div",{className:c().step,children:[(0,t.jsx)("span",{className:c().stepIcon,children:"\uD83D\uDCF8"}),(0,t.jsx)("span",{className:c().stepTitle,children:"1. Photo"})]}),(0,t.jsxs)("div",{className:c().step,children:[(0,t.jsx)("span",{className:c().stepIcon,children:"\uD83D\uDCE4"}),(0,t.jsx)("span",{className:c().stepTitle,children:"2. Upload"})]}),(0,t.jsxs)("div",{className:c().step,children:[(0,t.jsx)("span",{className:c().stepIcon,children:"✨"}),(0,t.jsx)("span",{className:c().stepTitle,children:"3. Fini !"})]})]}),(0,t.jsxs)("label",{className:c().uploadLabel,children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:A,className:c().fileInput,disabled:N}),(0,t.jsx)("span",{className:c().uploadBtn,children:N?"⏳ ".concat(C,"%"):"\uD83D\uDCE4 Changer le Menu"})]}),N&&(0,t.jsx)("div",{className:c().progressContainer,children:(0,t.jsx)("div",{className:c().progressBar,style:{width:"".concat(C,"%")}})}),p&&(0,t.jsxs)("div",{className:c().errorBox,children:["❌ ",p]}),I&&(0,t.jsx)("div",{className:c().success,children:"✅ Menu mis \xe0 jour !"})]}),(0,t.jsxs)("div",{className:c().previewSection,children:[(0,t.jsx)("h3",{children:_?"\uD83D\uDCE4 Aper\xe7u (upload...)":"Menu Actuel"}),_?(0,t.jsx)("img",{src:_,className:c().previewImage,style:{opacity:.8}}):g?(0,t.jsx)("img",{src:g,className:c().previewImage}):(0,t.jsx)("div",{className:c().noImage,children:"Aucun menu"})]})]}):(0,t.jsxs)("div",{className:c().uploadSection,children:[(0,t.jsx)("h2",{children:"\uD83D\uDDBC️ Ajouter \xe0 la Galerie"}),(0,t.jsxs)("div",{style:{marginBottom:"1.5rem",display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem"},children:[(0,t.jsx)("label",{style:{fontWeight:600},children:"Cat\xe9gorie :"}),(0,t.jsxs)("select",{value:x,onChange:e=>j(e.target.value),style:{padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #ddd",fontSize:"1rem"},children:[(0,t.jsx)("option",{value:"restaurant",children:"\uD83C\uDF7D️ Restaurant & Plats"}),(0,t.jsx)("option",{value:"events",children:"\uD83C\uDF89 \xc9v\xe9nements & F\xeates"})]})]}),(0,t.jsxs)("label",{className:c().uploadLabel,children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:F,className:c().fileInput,disabled:N}),(0,t.jsx)("span",{className:c().uploadBtn,children:N?"⏳ ".concat(C,"%"):"➕ Ajouter une photo"})]}),N&&(0,t.jsx)("div",{className:c().progressContainer,children:(0,t.jsx)("div",{className:c().progressBar,style:{width:"".concat(C,"%")}})}),I&&(0,t.jsx)("div",{className:c().success,children:"✅ Photo ajout\xe9e !"}),(0,t.jsx)("h3",{style:{marginTop:"2rem",textAlign:"left",borderBottom:"1px solid #eee",paddingBottom:"0.5rem"},children:"Vos Photos"}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1rem",marginTop:"1.5rem"},children:v.filter(e=>e.category===x).map(e=>(0,t.jsxs)("div",{style:{position:"relative",borderRadius:"0.5rem",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",background:"#fff"},children:[(0,t.jsx)("img",{src:e.url,alt:"Gallery",style:{width:"100%",aspectRatio:"1",objectFit:"cover"}}),(0,t.jsxs)("div",{style:{padding:"0.5rem",fontSize:"0.8rem",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#f8f9fa"},children:[(0,t.jsx)("span",{title:e.category,children:"restaurant"===e.category?"\uD83C\uDF7D️":"\uD83C\uDF89"}),(0,t.jsx)("button",{onClick:()=>R(e.id),style:{background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:"Supr."})]})]},e.id))})]})]})}):(0,t.jsx)("div",{className:c().container,children:(0,t.jsxs)("div",{className:c().loginCard,children:[(0,t.jsx)("div",{className:c().logo,children:"\uD83C\uDF5D"}),(0,t.jsx)("h1",{children:"Administration Trapeneck"}),(0,t.jsx)("p",{children:"Connectez-vous pour g\xe9rer le site"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"Pepperoni2022"===a?(r(!0),sessionStorage.setItem("trapeneck_admin","true"),m("")):m("Mot de passe incorrect")},className:c().form,children:[(0,t.jsx)("input",{type:"password",placeholder:"Mot de passe",value:a,onChange:e=>l(e.target.value),className:c().input}),p&&(0,t.jsx)("p",{className:c().error,children:p}),(0,t.jsx)("button",{type:"submit",className:c().button,children:"Se connecter"})]})]})})}},6410:function(e,r,a){"use strict";a.d(r,{NA:function(){return c},NQ:function(){return d},Ve:function(){return u},vU:function(){return l},vX:function(){return p}});var t=a(738),s=a(5978);let n=(0,t.ZF)({apiKey:"AIzaSyBEb-VBRW3ymcVl9oLjOAxAuk1L2jNC7jU",authDomain:"pepperoni-651c6.firebaseapp.com",projectId:"pepperoni-651c6",storageBucket:"pepperoni-651c6.firebasestorage.app",messagingSenderId:"1068626836984",appId:"1:1068626836984:web:52e0abbd1829f999426a0d",measurementId:"G-9RDWZNMVN3"}),o=(0,s.ad)(n),i="trapeneck_menu_url";async function l(e){try{localStorage.setItem(i,JSON.stringify({imageUrl:e,updatedAt:new Date().toISOString()}))}catch(e){console.warn("localStorage non disponible")}try{return await (0,s.pl)((0,s.JU)(o,"settings","trapeneck_menu"),{imageUrl:e,updatedAt:new Date().toISOString()}),{success:!0}}catch(e){return console.error("Erreur Firebase:",e),{success:!1,error:e.message||"Erreur Firebase"}}}async function c(){try{let e=await (0,s.QT)((0,s.JU)(o,"settings","trapeneck_menu"));if(e.exists())return e.data().imageUrl}catch(e){console.warn("Firebase non disponible, utilisation du localStorage")}try{{let e=localStorage.getItem(i);if(e)return JSON.parse(e).imageUrl}}catch(e){console.warn("localStorage non disponible")}return null}async function u(e,r){try{let a=(0,s.JU)((0,s.hJ)(o,"trapeneck_gallery"));return await (0,s.pl)(a,{url:e,category:r,createdAt:new Date().toISOString()}),{success:!0}}catch(e){return console.error("Erreur ajout galerie:",e),{success:!1,error:e.message||"Erreur inconnue"}}}async function d(){try{let e=(0,s.IO)((0,s.hJ)(o,"trapeneck_gallery"),(0,s.Xo)("createdAt","desc"));return(await (0,s.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Erreur lecture galerie:",e),[]}}async function p(e){try{return await (0,s.oe)((0,s.JU)(o,"trapeneck_gallery",e)),{success:!0}}catch(e){return console.error("Erreur suppression galerie:",e),{success:!1,error:e.message||"Erreur inconnue"}}}},7356:function(e){e.exports={container:"page_container__bKlsu",loginCard:"page_loginCard__g_zoW",logo:"page_logo__2iuHa",form:"page_form__0FWwx",input:"page_input__LzCRz",button:"page_button__XbX_N",error:"page_error__J8EiX",adminPanel:"page_adminPanel__93XMV",header:"page_header__GFEq6",logoutBtn:"page_logoutBtn__Qx2MZ",uploadSection:"page_uploadSection___HSuz",uploadLabel:"page_uploadLabel__3b4XN",fileInput:"page_fileInput__ndibQ",uploadBtn:"page_uploadBtn__Ghf4O",stepGuide:"page_stepGuide__vcM4u",step:"page_step___Bh4q",stepIcon:"page_stepIcon__RzOKz",stepTitle:"page_stepTitle___6vtE",stepDesc:"page_stepDesc__Is4pj",infoText:"page_infoText__WEbT3",errorBox:"page_errorBox__Zrt_3",success:"page_success__wK9AJ",successPop:"page_successPop__soCp1",progressContainer:"page_progressContainer__VDdqA",progressBar:"page_progressBar__8tuE0",previewSection:"page_previewSection__BL4tO",previewImage:"page_previewImage__CIkTb",noImage:"page_noImage__52vm3"}}},function(e){e.O(0,[491,609,448,971,117,744],function(){return e(e.s=1181)}),_N_E=e.O()}]);